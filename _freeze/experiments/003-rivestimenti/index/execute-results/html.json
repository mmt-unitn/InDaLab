{
  "hash": "ee75d5eeb46bbf6daf43c0d02916a80f",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Rivestimenti protettivi sol-gel ibridi nanocompositi.\"\nauthor: \"Tommaso Stefani\"\ndate: today\nformat: html\ndraft: false\ncategories: \n  - materiali\nabstract: >\n  In questa attività si realizzano dei rivestimenti sol-gel ibridi nanocompositi su un substrato di alluminio per identificare quali combinazioni di parametri garantisce le migliori prestazioni in termini di adesione e omogeneità del rivestimento (spessore uniforme).\n---\n\n\n# Premessa\n\nI dati riportati nel presente documento sono interamente generati a scopo didattico e non derivano da esperimenti reali. L’obiettivo principale è illustrare l’approccio sperimentale e statistico nell’analisi di rivestimenti sol-gel ibridi su substrati di legno di larice, mostrando come variano le proprietà di adesione e durezza in funzione dei parametri di sintesi.\n\nLe tabelle, i grafici e le analisi ANOVA presentati sono pertanto esemplificativi: servono esclusivamente a spiegare la metodologia.\n\nOgni valore numerico deve essere interpretato come un esempio illustrativo e non come un dato sperimentale reale.\n\nAnche i risultati delle analisi sono quindi da considerarsi unicamente a scopo esemplificativo.\n\n# Descrizione dell'attività\n\nIn questa attività si studiano e realizzano rivestimenti sol-gel ibridi nanocompositi su substrati di legno di larice, con l’obiettivo di individuare le combinazioni di parametri sperimentali che garantiscano le migliori prestazioni in termini di adesione, durezza e uniformità dei valori di durezza sulla superficie del rivestimento.\n\nPer materiali quali l'acciaio questi rivestimenti rappresentano un’alternativa ai tradizionali trattamenti cromati o chimici più impattanti, rispondendo alla crescente esigenza di soluzioni **eco-friendly** e sostenibili nell’ambito dei materiali protettivi.\n\nIn particolare si andrà a valutare l'impatto dei seguenti fattori:\n\n* ph della soluzione di $HCl$\n* rapporto inorganico/organico\n\nsui seguenti parametri assunti come risposta:\n \n * forza di adesione\n * durezza\n * omogeneità (l'opposto della varianza) del rivestimento in termini di durezza\n \nAllo scopo si seguirà l'approcio statistico basato sul **central composite design (CCD)** il quale permette di verificare una eventuale curvatura della risposta.\n\n# Cenni teorici\n\n## Chimica dei rivestimenti sol–gel ibridi\n\nI rivestimenti sol–gel si basano sulla trasformazione di precursori alchil- o trialcoxisilani in una rete solida di silice tramite **idrolisi e condensazione**.  \nNel caso dei rivestimenti ibridi organico-inorganici, i precursori più comuni sono:  \n\n- **TEOS (tetraetilortosilicato, $Si(OC_2H_5)_4$)**: componente inorganica, responsabile della formazione della rete $Si–O–Si$.  \n- **GPTMS (3-glicidossipropiltrimetossisilano, $C_9H_{20}O_5Si$)**: componente organica, che conferisce funzionalità reattive e flessibilità alla rete.\n\n### Idrolisi dei precursori\nL’idrolisi di TEOS o GPTMS avviene in presenza di acqua e di un catalizzatore acido o basico, trasformando i gruppi alchossilici in gruppi silanolici ($Si–OH$):\n\n$$\nSi(OR)_4 + 4 H_2O \\rightarrow Si(OH)_4 + 4 ROH\n$$\n\ndove $R$ può essere un gruppo etilico (nel TEOS) o metilico (nel GPTMS).  \n\n### Condensazione e formazione della rete\nI gruppi silanolici generati reagiscono tra loro formando legami silossanici ($Si–O–Si$) e liberando acqua o alcol:\n\n$$\nSi–OH + HO–Si \\rightarrow Si–O–Si + H_2O\n$$\n\noppure\n\n$$\nSi–OH + Si–OR \\rightarrow Si–O–Si + ROH\n$$\n\nQueste reazioni di **condensazione** portano alla formazione di una rete tridimensionale solida, responsabile delle proprietà barriera e meccaniche del rivestimento.\n\n### Formazione del rivestimento ibrido\n\nNel caso di GPTMS, il gruppo organico epossidico può ulteriormente reagire con gruppi amminici o idrossilici presenti nell’ambiente, creando un **reticolo ibrido organico-inorganico**:\n\n$$\nR–CH–(epossido) + R'–OH \\rightarrow R–CH–OH–R'\n$$\n\nQuesto legame organico conferisce flessibilità e migliora l’adesione al substrato metallico.  \n\n### Sintesi controllata\n\nLa **composizione e le condizioni di processo** (rapporto $TEOS/GPTMS$, pH, temperatura di essiccazione ecc.) influenzano profondamente:\n\n- la densità della rete $Si–O–Si$;  \n- la distribuzione dei gruppi organici;  \n- la resistenza all’adesione, lo spessore e lan resistenza alla corrosione del rivestimento finale.\n\n## Central composite design - CCD\n\nIl **Central Composite Design (CCD)** è una metodologia di progettazione sperimentale molto utilizzata nelle analisi di ottimizzazione dei processi chimici e dei materiali, particolarmente indicata quando si sospettano effetti non lineari. Questo disegno sperimentale permette di valutare preventivamente la **curvature** del modello di risposta, aggiungendo punti centrali replicati che migliorano la stima della variabilità sperimentale e la riproducibilità dei risultati.  \n\nGrazie alla sua struttura preventiva, il CCD permette di prevedere il comportamento del sistema nei valori intermedi delle variabili, senza la necessità di testare ogni possibile combinazione sperimentale, migliorando così l’efficienza e l’affidabilità dell’ottimizzazione del processo.\n\n\n# Parte sperimentale\n\n## Apparecchiatura\n\nPer svolgere l'attività è necessaria la seguente apparecchiatura:\n\n* metiltrietossisilano $CH_3Si(C_2H_5O)_3$ (precursore organico - MTES)\n* tetraetilsilicato $Si(OC_2H_5)_4$ (precursore inorganico - TEOS)\n* etanolo $CH_3CH_2OH$\n* soluzione $HCl$ con ph 1\n* soluzione $HCl$ con ph 4\n* palloncino con tappo da 100 ml\n* pipetta\n* propipetta\n* agitatore magnetico\n* substrati di alluminio\n* matite per test della matita\n* lente per test dell'adesione\n* scotch per test dell'adesione\n* taglierino a griglia per test dell adesione\n\n## Procedimento\n\nSi riporta lo svolgimento necessario per condurre una prova.\n\nPer la preparazione del sol-gel:\n\n1. Posizionare il palloncino sotto cappa aspirante, fissandolo con un supporto adatto (asta + morsetto).\n2. Collocare l’agitatore magnetico sotto il pallone e inserire al suo interno una barretta magnetica.\n\n3. Si inserisce la quantità di MTES prevista dalla prova e 15 ml di M (quantità fissa per tutte le prove).\n4. Si lascia agitare per 5 minuti verificando che non vi siano precipitazioni o reazioni non previste.\n5. Si aggiungono 1,3 ml (quantità fissa) di soluzione di $HCl$ con ph previsto dalla prova.\n6. Si lascia agitare per 5 minuti verificando che non vi siano precipitazioni o reazioni non previste.\n7. Si aggiuge la quantità di TEOS prevista dalla prova\n8. Si lascia agitare per 30 minuti.\n\nPer applicare il sol-gel al substrato scelto:\n\n1. Si scelglie un campione che permetta di eseguire tutte le misure previste dal piano fattoriale.\n2. Si prepara il campione pulendo con etanolo\n3. Si applica il sol-gel tramite pennello (si possono utilizzare anche altre metodologie) stendendo uno strato uniforme e ponendo attenzione ad applicarlo in maniera uguale ai campioni delle altre prove.\n4. Si lascia asciugare fino a solidificazione.\n\nPer le misure di adesione (secondo **UNI EN ISO 2409**):\n\n1. Preparazione del campione: assicurarsi che la superficie rivestita sia asciutta e pulita.\n\n2. Esecuzione della grigliatura: con un apposito taglierino o strumento, incidere sulla superficie una serie di tagli paralleli e perpendicolari, formando una griglia (il numero e la distanza dipendono dallo spessore del rivestimento).\n\n3. Applicazione del nastro adesivo: applicare sopra la griglia un pezzo di nastro adesivo standardizzato (scotch), premendolo bene per garantire il contatto.\n\n4. Rimozione del nastro: staccare il nastro con un movimento rapido e deciso.\n\n5. Valutazione: confrontare la superficie incisa con le classificazioni previste dalla norma UNI EN ISO 2409, che vanno da 0 (adesione ottima, nessun distacco) a 5 (adesione scarsa, ampi distacchi).\n\n\n4. Allineare la linea presente su uno dei due corsoi con una delle diagonali dell'impronta, in modo da fissare l'orientamento corretto per la misurazione \n\n<div style=\"text-align:center\">\n![classi di adesione previste da UNI EN ISO 2409](images/classi_adesione.jpg){width=50%}\n</div>\n\nPer le misure di durezza:\n\nPer le misure di durezza (secondo **UNI 10782**):\n\n1. Preparazione del campione: pulire e asciugare la superficie da testare.\n\n2. Scelta delle matite: utilizzare una serie di matite normalizzate con durezza progressiva (da 8B, molto morbida, a 8H, molto dura).\n\n3. Preparazione delle punte: appuntire le matite e spianare la punta a 90° su carta abrasiva per avere una superficie piatta e uniforme.\n\n4. Esecuzione del test: posizionare la matita sul rivestimento con un angolo di circa 45° e spingerla in avanti esercitando una pressione costante.\n\n5. Valutazione: individuare la matita più dura che non incide o non scalfisce il film superficiale.\n\n6. Risultato: la durezza del rivestimento viene classificata con il grado della matita corrispondente (es. “HB”, “F”, “2H”).\n\n## Calcolo delle quantità di MTES e di TEOS\n\nNel calcolo delle quantità si mantiene costante il numero di moli di TEOS, mentre la quantità di MTES viene variata in modo da rispettare il rapporto inorganico/organico stabilito. Una volta determinato il numero di moli di MTES necessario, questo viene convertito prima in grammi (tramite la massa molare) e successivamente in millilitri (tramite la densità).\n\nIn questo modo, fissando il TEOS come riferimento, si ottengono i volumi corretti dei due precursori da introdurre nel pallone. Il rapporto inorganico/organico definisce quindi direttamente la quantità di MTES da aggiungere affinché il rapporto molare tra precursore inorganico e organico sia rispettato.\n\n## Informazioni di sicurezza\n\n\n* Metiltrietossisilano (MTES): infiammabile, irritante per occhi e vie respiratorie. Usare sotto cappa chimica.\n* Tetraetilsilicato (TEOS): infiammabile, irritante per occhi, pelle e vie respiratorie. Usare sotto cappa chimica.\n* Etanolo: altamente infiammabile. Tenere lontano da fiamme libere o superfici calde.\n* Soluzioni acide ($H_2O$ pH 1 e pH 4): corrosive (pH 1) o irritanti (pH 4). Manipolare con guanti e occhiali di protezione.\n* Scotch, matite, taglierino a griglia: rischi meccanici di taglio o scheggiature. Maneggiare con cautela.\n\n# Elaborazione dei dati\n\nSi specifica nuovamente che i dati utilizzati nel seguito **non derivano da esperimenti reali**, ma sono stati generati a titolo esemplificativo. **I risultati presentati nel documento non hanno quindi valore scientifico e non corrispondono ad evidenze sperimentali reali**.\n\n## Analisi ANOVA con CCD \n\n### Piano fattoriale\n\nSi crea il piano fattoriale $2 \\cdot 2^2$ con l'aggiunta di un punto centrale ripetuto 5 volte (per vereificare la presenza o meno di curvatura della risposta).Si ha quindi un piano fattoriale a *central composite design*. Si sottolinea che per fare analisi statistica è necessario ripetere tutti i punti (compreso quello centrale) almeno 2 volte.\n\nIn quanto si vuole valutare la risposta in termini di adesione e di durezza del rivestimento sono presenti entrambe nel piano. Inoltre le misure di durezza sono ripetute 4 volte in punti diversi del campione perchè si desidera valutare l'omogeneità della risposta in termini di durezza.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndm<-fp_design_matrix(2,rep=2)%>%\n  fp_add_names(A=\"ph\",B=\"inorganico_organico\")%>%\n  fp_add_scale(A=c(1,4),B=c(1,9))%>%\n  fp_augment_center(rep=5)%>%\n  rename(\n    ades=Y\n  )%>%\n  add_column(\n    dur1=NA,\n    dur2=NA,\n    dur3=NA,\n    dur4=NA \n  )\n\nkable(dm,caption = \"piano fattoriale con design centrale\")\n```\n\n::: {.cell-output-display}\n\n\nTable: piano fattoriale con design centrale\n\n| StdOrder| RunOrder|.treat | .rep|  A|  B| A_s| B_s|ades |dur1 |dur2 |dur3 |dur4 |\n|--------:|--------:|:------|----:|--:|--:|---:|---:|:----|:----|:----|:----|:----|\n|        1|        5|(1)    |    1| -1| -1| 1.0|   1|NA   |NA   |NA   |NA   |NA   |\n|        2|        2|a      |    1|  1| -1| 4.0|   1|NA   |NA   |NA   |NA   |NA   |\n|        3|        8|b      |    1| -1|  1| 1.0|   9|NA   |NA   |NA   |NA   |NA   |\n|        4|        1|ab     |    1|  1|  1| 4.0|   9|NA   |NA   |NA   |NA   |NA   |\n|        5|        3|(1)    |    2| -1| -1| 1.0|   1|NA   |NA   |NA   |NA   |NA   |\n|        6|        7|a      |    2|  1| -1| 4.0|   1|NA   |NA   |NA   |NA   |NA   |\n|        7|        4|b      |    2| -1|  1| 1.0|   9|NA   |NA   |NA   |NA   |NA   |\n|        8|        6|ab     |    2|  1|  1| 4.0|   9|NA   |NA   |NA   |NA   |NA   |\n|        9|       12|center |    1|  0|  0| 2.5|   5|NA   |NA   |NA   |NA   |NA   |\n|       10|        9|center |    2|  0|  0| 2.5|   5|NA   |NA   |NA   |NA   |NA   |\n|       11|       13|center |    3|  0|  0| 2.5|   5|NA   |NA   |NA   |NA   |NA   |\n|       12|       11|center |    4|  0|  0| 2.5|   5|NA   |NA   |NA   |NA   |NA   |\n|       13|       10|center |    5|  0|  0| 2.5|   5|NA   |NA   |NA   |NA   |NA   |\n\n\n:::\n:::\n\n\n### Raccolta dati\n\n\n* Per quanto riguarda il test dell'adesione, si assegnano valori da **0** (classe 0) a **5** (classe 5).\n\n* Per quanto riguarda la misura della durezza, il test delle matite prevede di assegnare un livello di durezza tra i seguenti:\n\n<div style=\"text-align:center\">\n**8B, 7B, 6B, 5B, 4B, 3B, 2B, B, HB, F, H, 2H, 3H, 4H, 5H, 6H, 7H, 8H**\n</div\n\nPer consentire un’analisi statistica, a ogni classe di durezza viene assegnato un numero crescente, **da 1 per 8B a 18 per 8H**.\n\nSi importano i dati raccolti:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nset.seed(0)\n\ndm$ades=c(1,1,2,3,1,2,2,3,2,1,2,3,2)\ndm$dur1=c(9,9,10,10,9,9,10,11,9,10,10,10,10)\ndm$dur2=c(9,9,10,10,9,9,11,11,9,10,11,10,10)\ndm$dur3=c(9,10,10,10,8,9,10,10,10,10,10,11,10)\ndm$dur4=c(9,9,11,11,9,9,11,11,9,11,10,10,10)\n\nkable(dm,caption=\"piano fattoriale con dati raccolti in laboratorio\")\n```\n\n::: {.cell-output-display}\n\n\nTable: piano fattoriale con dati raccolti in laboratorio\n\n| StdOrder| RunOrder|.treat | .rep|  A|  B| A_s| B_s| ades| dur1| dur2| dur3| dur4|\n|--------:|--------:|:------|----:|--:|--:|---:|---:|----:|----:|----:|----:|----:|\n|        1|        5|(1)    |    1| -1| -1| 1.0|   1|    1|    9|    9|    9|    9|\n|        2|        2|a      |    1|  1| -1| 4.0|   1|    1|    9|    9|   10|    9|\n|        3|        8|b      |    1| -1|  1| 1.0|   9|    2|   10|   10|   10|   11|\n|        4|        1|ab     |    1|  1|  1| 4.0|   9|    3|   10|   10|   10|   11|\n|        5|        3|(1)    |    2| -1| -1| 1.0|   1|    1|    9|    9|    8|    9|\n|        6|        7|a      |    2|  1| -1| 4.0|   1|    2|    9|    9|    9|    9|\n|        7|        4|b      |    2| -1|  1| 1.0|   9|    2|   10|   11|   10|   11|\n|        8|        6|ab     |    2|  1|  1| 4.0|   9|    3|   11|   11|   10|   11|\n|        9|       12|center |    1|  0|  0| 2.5|   5|    2|    9|    9|   10|    9|\n|       10|        9|center |    2|  0|  0| 2.5|   5|    1|   10|   10|   10|   11|\n|       11|       13|center |    3|  0|  0| 2.5|   5|    2|   10|   11|   10|   10|\n|       12|       11|center |    4|  0|  0| 2.5|   5|    3|   10|   10|   11|   10|\n|       13|       10|center |    5|  0|  0| 2.5|   5|    2|   10|   10|   10|   10|\n\n\n:::\n:::\n\n\nA questo punto si aggiungono le due colonne media e varianza per la grandezza della durezza e si rimuovono le 4 colonne relative alle misure della durezza in quanto non interessano più ( perchè si affronta l'analisi considerando la media e la varianza della stessa).\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndm<-dm %>% \n  rowwise() %>% # opera per righe\n  mutate(\n    dur_media=mean(c(dur1,dur2,dur3,dur4)),\n    dur_var=var(c(dur1,dur2,dur3,dur4))\n  ) %>% \n  ungroup() %>% \n  select(-(dur1:dur4)) \n\nkable(dm,caption=\"piano fattoriale media e varianza delle grandezze adesione e spessore\")\n```\n\n::: {.cell-output-display}\n\n\nTable: piano fattoriale media e varianza delle grandezze adesione e spessore\n\n| StdOrder| RunOrder|.treat | .rep|  A|  B| A_s| B_s| ades| dur_media|   dur_var|\n|--------:|--------:|:------|----:|--:|--:|---:|---:|----:|---------:|---------:|\n|        1|        5|(1)    |    1| -1| -1| 1.0|   1|    1|      9.00| 0.0000000|\n|        2|        2|a      |    1|  1| -1| 4.0|   1|    1|      9.25| 0.2500000|\n|        3|        8|b      |    1| -1|  1| 1.0|   9|    2|     10.25| 0.2500000|\n|        4|        1|ab     |    1|  1|  1| 4.0|   9|    3|     10.25| 0.2500000|\n|        5|        3|(1)    |    2| -1| -1| 1.0|   1|    1|      8.75| 0.2500000|\n|        6|        7|a      |    2|  1| -1| 4.0|   1|    2|      9.00| 0.0000000|\n|        7|        4|b      |    2| -1|  1| 1.0|   9|    2|     10.50| 0.3333333|\n|        8|        6|ab     |    2|  1|  1| 4.0|   9|    3|     10.75| 0.2500000|\n|        9|       12|center |    1|  0|  0| 2.5|   5|    2|      9.25| 0.2500000|\n|       10|        9|center |    2|  0|  0| 2.5|   5|    1|     10.25| 0.2500000|\n|       11|       13|center |    3|  0|  0| 2.5|   5|    2|     10.25| 0.2500000|\n|       12|       11|center |    4|  0|  0| 2.5|   5|    3|     10.25| 0.2500000|\n|       13|       10|center |    5|  0|  0| 2.5|   5|    2|     10.00| 0.0000000|\n\n\n:::\n:::\n\n\n### Analisi ANOVA\n\nE' evidente che la risposta si riferisce a 3 grandezze:\n\n* adesione\n* durezza media\n* varianza della durezza\n\nSarà quindi necessario effettuare 3 relative analisi anova. Nel modello lineare si inserisce un termine quadratico per verificare se vi sia un'eventuale curvatura della risposta ( il piano prevedeva punto centrale prorpio a questo scopo).\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndm_ades.lm<-lm(ades ~ A*B+I(A^2), data = dm)\ndm_dur.lm<-lm(dur_media ~ A*B+I(A^2), data = dm)\ndm_dur_var.lm<-lm(dur_var ~ A*B+I(A^2), data = dm)\n\nanova(dm_ades.lm)%>%kable(caption = \"Tabella ANOVA per adesione\")\n```\n\n::: {.cell-output-display}\n\n\nTable: Tabella ANOVA per adesione\n\n|          | Df|    Sum Sq|   Mean Sq|    F value|    Pr(>F)|\n|:---------|--:|---------:|---------:|----------:|---------:|\n|A         |  1| 1.1250000| 1.1250000|  3.6000000| 0.0943498|\n|B         |  1| 3.1250000| 3.1250000| 10.0000000| 0.0133491|\n|I(A^2)    |  1| 0.0480769| 0.0480769|  0.1538462| 0.7051292|\n|A:B       |  1| 0.1250000| 0.1250000|  0.4000000| 0.5447373|\n|Residuals |  8| 2.5000000| 0.3125000|         NA|        NA|\n\n\n:::\n\n```{.r .cell-code}\nanova(dm_dur.lm)%>%kable(caption = \"Tabella ANOVA per media della durezza\")\n```\n\n::: {.cell-output-display}\n\n\nTable: Tabella ANOVA per media della durezza\n\n|          | Df|    Sum Sq|   Mean Sq|    F value|    Pr(>F)|\n|:---------|--:|---------:|---------:|----------:|---------:|\n|A         |  1| 0.0703125| 0.0703125|  0.5806452| 0.4679274|\n|B         |  1| 4.1328125| 4.1328125| 34.1290323| 0.0003863|\n|I(A^2)    |  1| 0.2433894| 0.2433894|  2.0099256| 0.1940247|\n|A:B       |  1| 0.0078125| 0.0078125|  0.0645161| 0.8059018|\n|Residuals |  8| 0.9687500| 0.1210938|         NA|        NA|\n\n\n:::\n\n```{.r .cell-code}\nanova(dm_dur_var.lm)%>%kable(caption = \"Tabella ANOVA per varianza della durezza\")\n```\n\n::: {.cell-output-display}\n\n\nTable: Tabella ANOVA per varianza della durezza\n\n|          | Df|    Sum Sq|   Mean Sq|   F value|    Pr(>F)|\n|:---------|--:|---------:|---------:|---------:|---------:|\n|A         |  1| 0.0008681| 0.0008681| 0.0598802| 0.8128450|\n|B         |  1| 0.0425347| 0.0425347| 2.9341317| 0.1250791|\n|I(A^2)    |  1| 0.0000134| 0.0000134| 0.0009212| 0.9765300|\n|A:B       |  1| 0.0008681| 0.0008681| 0.0598802| 0.8128450|\n|Residuals |  8| 0.1159722| 0.0144965|        NA|        NA|\n\n\n:::\n:::\n\n\n#### Analisi dei residui per l'adesione\n\nSi verificano i residui in termini di assenza di pattern. L'analisi della normalità non viene condotta in quanto i valori sono discretizzati in 5 classi e quindi non avrebbe significato.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\np1<-dm%>%\n  add_residuals(dm_ades.lm)%>%\n  ggplot(aes(x=A,y=resid))+\n  geom_point()+\n   labs(\n    x = \"ph\",\n    y = \"Residui\"\n  )\n\np2<-dm%>%\n  add_residuals(dm_ades.lm)%>%\n  ggplot(aes(x=B,y=resid))+\n  geom_point()+\n   labs(\n    x = \"inorganico/organico\",\n    y = \"Residui\"\n  )\n\np3<-dm%>%\n  add_residuals(dm_ades.lm)%>%\n  ggplot(aes(x=RunOrder,y=resid))+\n  geom_point()+\n   labs(\n    x = \"RunOrder\",\n    y = \"Residui\"\n  )\n\np4<-dm%>%\n  add_residuals(dm_ades.lm)%>%\n  add_predictions(dm_ades.lm)%>%\n  ggplot(aes(x=pred,y=resid))+\n  geom_point()+\n   labs(\n    x = \"Predizioni\",\n    y = \"Residui\"\n  )\n\np1 / p2 / p3/ p4 + plot_annotation(title = \"Residui dell'adesione\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){fig-align='center' width=16cm}\n:::\n:::\n\n\n#### Analisi dei residui per la media della durezza\n\nSi verificano i residui in termini di assenza di pattern e normalità.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\np1<-dm%>%\n  add_residuals(dm_dur.lm)%>%\n  ggplot(aes(x=A,y=resid))+\n  geom_point()+\n   labs(\n    x = \"ph\",\n    y = \"Residui\"\n  )\n\np2<-dm%>%\n  add_residuals(dm_dur.lm)%>%\n  ggplot(aes(x=B,y=resid))+\n  geom_point()+\n   labs(\n    x = \"inorganico/organico\",\n    y = \"Residui\"\n  )\n\np3<-dm%>%\n  add_residuals(dm_dur.lm)%>%\n  ggplot(aes(x=RunOrder,y=resid))+\n  geom_point()+\n   labs(\n    x = \"RunOrder\",\n    y = \"Residui\"\n  )\n\np4<-dm%>%\n  add_residuals(dm_dur.lm)%>%\n  add_predictions(dm_dur.lm)%>%\n  ggplot(aes(x=pred,y=resid))+\n  geom_point()+\n   labs(\n    x = \"Predizioni\",\n    y = \"Residui\"\n   )\n\np1 / p2 / p3/ p4 + plot_annotation(title = \"Residui della media della durezza\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-7-1.png){fig-align='center' width=16cm}\n:::\n\n```{.r .cell-code}\ndm%>%\n  add_residuals(dm_dur.lm)%>%\n  ggplot(aes(sample=resid))+\n  geom_qq()+\n  geom_qq_line(color=\"red\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-7-2.png){fig-align='center' width=16cm}\n:::\n\n```{.r .cell-code}\ndm%>%\n  add_residuals(dm_dur.lm)%>%\n  pull(resid)%>%\n  shapiro.test()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  .\nW = 0.81915, p-value = 0.01162\n```\n\n\n:::\n:::\n\n#### Analisi dei residui per la varianza della durezza\n\nSi verificano i residui in termini di assenza di pattern e normalità.\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\np1<-dm%>%\n  add_residuals(dm_dur_var.lm)%>%\n  ggplot(aes(x=A,y=resid))+\n  geom_point()+\n   labs(\n    x = \"ph\",\n    y = \"Residui\"\n  )\n\np2<-dm%>%\n  add_residuals(dm_dur_var.lm)%>%\n  ggplot(aes(x=B,y=resid))+\n  geom_point()+\n   labs(\n    x = \"inorganico/organico\",\n    y = \"Residui\"\n  )\n\np3<-dm%>%\n  add_residuals(dm_dur_var.lm)%>%\n  ggplot(aes(x=RunOrder,y=resid))+\n  geom_point()+\n   labs(\n    x = \"RunOrder\",\n    y = \"Residui\"\n  )\n\np4<-dm%>%\n  add_residuals(dm_dur_var.lm)%>%\n  add_predictions(dm_dur_var.lm)%>%\n  ggplot(aes(x=pred,y=resid))+\n  geom_point()+\n   labs(\n    x = \"Predizioni\",\n    y = \"Residui\"\n  )\n\np1 / p2 / p3/ p4 + plot_annotation(title = \"Residui della varianza della durezza\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-8-1.png){fig-align='center' width=16cm}\n:::\n\n```{.r .cell-code}\ndm%>%\n  add_residuals(dm_dur_var.lm)%>%\n  ggplot(aes(sample=resid))+\n  geom_qq()+\n  geom_qq_line(color=\"red\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-8-2.png){fig-align='center' width=16cm}\n:::\n\n```{.r .cell-code}\ndm%>%\n  add_residuals(dm_dur_var.lm)%>%\n  pull(resid)%>%\n  shapiro.test()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  .\nW = 0.90139, p-value = 0.1397\n```\n\n\n:::\n:::\n\n\n### Analisi ANOVA senza termine quadratico e termini non significativi\n\nPer nessuna delle risposte risulta significativo il termine quadratico quindi ripetiamo l'analisi anova non considerando i termini quadratici e i termini non significativi  dell'analisi precedente.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndm_ades.lm<-lm(ades ~ A+B, data = dm)\ndm_dur.lm<-lm(dur_media ~ B, data = dm)\ndm_dur_var.lm<-lm(dur_var ~ B, data = dm)\n\nanova(dm_ades.lm)%>%kable(caption = \"Tabella ANOVA per l'adesione\")\n```\n\n::: {.cell-output-display}\n\n\nTable: Tabella ANOVA per l'adesione\n\n|          | Df|   Sum Sq|   Mean Sq|   F value|    Pr(>F)|\n|:---------|--:|--------:|---------:|---------:|---------:|\n|A         |  1| 1.125000| 1.1250000|  4.208633| 0.0673395|\n|B         |  1| 3.125000| 3.1250000| 11.690648| 0.0065567|\n|Residuals | 10| 2.673077| 0.2673077|        NA|        NA|\n\n\n:::\n\n```{.r .cell-code}\nanova(dm_dur.lm)%>%kable(caption = \"Tabella ANOVA per la media della durezza\")\n```\n\n::: {.cell-output-display}\n\n\nTable: Tabella ANOVA per la media della durezza\n\n|          | Df|   Sum Sq|   Mean Sq|  F value|   Pr(>F)|\n|:---------|--:|--------:|---------:|--------:|--------:|\n|B         |  1| 4.132812| 4.1328125| 35.23381| 9.79e-05|\n|Residuals | 11| 1.290264| 0.1172968|       NA|       NA|\n\n\n:::\n\n```{.r .cell-code}\nanova(dm_dur_var.lm)%>%kable(caption = \"Tabella ANOVA per la varianza della durezza\")\n```\n\n::: {.cell-output-display}\n\n\nTable: Tabella ANOVA per la varianza della durezza\n\n|          | Df|    Sum Sq|   Mean Sq|  F value|    Pr(>F)|\n|:---------|--:|---------:|---------:|--------:|---------:|\n|B         |  1| 0.0425347| 0.0425347| 3.974475| 0.0715833|\n|Residuals | 11| 0.1177217| 0.0107020|       NA|        NA|\n\n\n:::\n:::\n\nSi verificano come usuale i residui al fine di validare i modelli.\n\n\n\n#### Analisi dei residui per l'adesione\n\nSi verificano i residui in termini di assenza di pattern. L'analisi della normalità non viene condotta in quanto i valori sono discretizzati in 5 classi e quindi non avrebbe significato.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\np1<-dm%>%\n  add_residuals(dm_ades.lm)%>%\n  ggplot(aes(x=A,y=resid))+\n  geom_point()+\n   labs(\n    x = \"ph\",\n    y = \"Residui\"\n  )\n\np2<-dm%>%\n  add_residuals(dm_ades.lm)%>%\n  ggplot(aes(x=B,y=resid))+\n  geom_point()+\n   labs(\n    x = \"inorganico/organico\",\n    y = \"Residui\"\n  )\n\np3<-dm%>%\n  add_residuals(dm_ades.lm)%>%\n  ggplot(aes(x=RunOrder,y=resid))+\n  geom_point()+\n   labs(\n    x = \"RunOrder\",\n    y = \"Residui\"\n  )\n\np4<-dm%>%\n  add_residuals(dm_ades.lm)%>%\n  add_predictions(dm_ades.lm)%>%\n  ggplot(aes(x=pred,y=resid))+\n  geom_point()+\n   labs(\n    x = \"Predizioni\",\n    y = \"Residui\"\n  )\n\np1 / p2 / p3/ p4 + plot_annotation(title = \"Residui dell'adesione\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-10-1.png){fig-align='center' width=16cm}\n:::\n:::\n\n\n#### Analisi dei residui per la media della durezza\n\nSi verificano i residui in termini di assenza di pattern e normalità.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\np2<-dm%>%\n  add_residuals(dm_dur.lm)%>%\n  ggplot(aes(x=B,y=resid))+\n  geom_point()+\n   labs(\n    x = \"inorganico/organico\",\n    y = \"Residui\"\n  )\n\np3<-dm%>%\n  add_residuals(dm_dur.lm)%>%\n  ggplot(aes(x=RunOrder,y=resid))+\n  geom_point()+\n   labs(\n    x = \"RunOrder\",\n    y = \"Residui\"\n  )\n\np4<-dm%>%\n  add_residuals(dm_dur.lm)%>%\n  add_predictions(dm_dur.lm)%>%\n  ggplot(aes(x=pred,y=resid))+\n  geom_point()+\n   labs(\n    x = \"Predizioni\",\n    y = \"Residui\"\n   )\n\np2 / p3/ p4 + plot_annotation(title = \"Residui della media della durezza\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-11-1.png){fig-align='center' width=16cm}\n:::\n\n```{.r .cell-code}\ndm%>%\n  add_residuals(dm_dur.lm)%>%\n  ggplot(aes(sample=resid))+\n  geom_qq()+\n  geom_qq_line(color=\"red\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-11-2.png){fig-align='center' width=16cm}\n:::\n\n```{.r .cell-code}\ndm%>%\n  add_residuals(dm_dur.lm)%>%\n  pull(resid)%>%\n  shapiro.test()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  .\nW = 0.93561, p-value = 0.4027\n```\n\n\n:::\n:::\n\n#### Analisi dei residui per la varianza della durezza\n\nSi verificano i residui in termini di assenza di pattern e normalità.\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\np2<-dm%>%\n  add_residuals(dm_dur_var.lm)%>%\n  ggplot(aes(x=B,y=resid))+\n  geom_point()+\n   labs(\n    x = \"inorganico/organico\",\n    y = \"Residui\"\n  )\n\np3<-dm%>%\n  add_residuals(dm_dur_var.lm)%>%\n  ggplot(aes(x=RunOrder,y=resid))+\n  geom_point()+\n   labs(\n    x = \"RunOrder\",\n    y = \"Residui\"\n  )\n\np4<-dm%>%\n  add_residuals(dm_dur_var.lm)%>%\n  add_predictions(dm_dur_var.lm)%>%\n  ggplot(aes(x=pred,y=resid))+\n  geom_point()+\n   labs(\n    x = \"Predizioni\",\n    y = \"Residui\"\n  )\n\np2 / p3/ p4 + plot_annotation(title = \"Residui della varianza della durezza\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-12-1.png){fig-align='center' width=16cm}\n:::\n\n```{.r .cell-code}\ndm%>%\n  add_residuals(dm_dur_var.lm)%>%\n  ggplot(aes(sample=resid))+\n  geom_qq()+\n  geom_qq_line(color=\"red\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-12-2.png){fig-align='center' width=16cm}\n:::\n\n```{.r .cell-code}\ndm%>%\n  add_residuals(dm_dur_var.lm)%>%\n  pull(resid)%>%\n  shapiro.test()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  .\nW = 0.90151, p-value = 0.1403\n```\n\n\n:::\n:::\n\n\n## Superfici di riposta\n\nSi puo ora visualizzare tramite un grafico a superficie di riposta (i fattori sono in coded unit) come diverse combinazioni dei due fattori considerati abbiano effetto in termini di:\n\n* adesione\n* durezza\n* disomogeneità (varianza) della durezza in diversi punti del campione\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ngrid <- expand.grid(\n  A = seq(min(dm$A), max(dm$A), length.out = 10),\n  B = seq(min(dm$B), max(dm$B), length.out = 10)\n)\n\ngrid$pred_ades <- predict(dm_ades.lm, newdata = grid)\ngrid$pred_dur <- predict(dm_dur.lm, newdata = grid)\ngrid$pred_dur_var <- predict(dm_dur_var.lm, newdata = grid)\n\nggplot(grid, aes(x = A, y = B, z = pred_ades)) +\n  geom_contour_filled()+\n  labs(\n    title=\"Superficie di riposta per l'adesione\",\n    x=\"ph\",\n    y=\"inorganico/organico\",\n    fill=\"adesione\"\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-13-1.png){fig-align='center' width=16cm}\n:::\n\n```{.r .cell-code}\nggplot(grid, aes(x = A, y = B, z = pred_dur)) +\n  geom_contour_filled()+\n  labs(\n    title=\"Superficie di riposta per la durezza\",\n    x=\"ph\",\n    y=\"inorganico/organico\",\n    fill=\"spessore\"\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-13-2.png){fig-align='center' width=16cm}\n:::\n\n```{.r .cell-code}\nggplot(grid, aes(x = A, y = B, z = pred_dur_var)) +\n  geom_contour_filled()+\n  labs(\n    title=\"Superificie di riposta per la varianza della durezza\",\n    x=\"ph\",\n    y=\"inorganico/organico\",\n    fill=\"varianza dello spessore\"\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-13-3.png){fig-align='center' width=16cm}\n:::\n:::\n\nPotrebbe essere di interesse osservare quali combinazioni dei fattori garantiscono che la varianza della durezza sia al di sotto di un certo valore `soglia`  e determinati valori di durezza stessa.\n\nIl seguente grafico permette di visualizzare quali combinazioni di fattori garantiscano una varianza della durezza al di sotto un certo valore (in questo caso assunto arbitrariamente) e i relativi valori di durezza. In seguito i grafici oltre ad avere gli assi espressi in coded unit sono espressi in unità reali.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nsoglia <- 0.25\n\ncentro_maggiore <- grid %>%\n  filter(pred_dur_var > soglia) %>%\n  summarise(\n    x = mean(A),\n    y = mean(B)\n  )\n\ncentro_minore<-grid %>%\n  filter(pred_dur_var < soglia) %>%\n  summarise(\n    x = mean(A),\n    y = mean(B)\n  )\n\nx_label <- min(grid$A)\ny_label <- max(grid$B)\n\nggplot(grid, aes(x = A, y = B, z = pred_dur)) +\n  geom_contour_filled() +                     \n  geom_contour_filled(aes(z = pred_dur_var),   \n                      breaks = c(soglia, max(grid$pred_dur_var)),\n                      alpha = 0.5,\n                      fill=\"black\") +\n  geom_contour(aes(z=pred_dur_var), breaks = c(soglia, max(grid$pred_dur_var)))+\n  metR::geom_label_contour(aes(z=pred_dur_var),breaks = soglia)+\n  labs(\n    title =\"Superficie di riposta della durezza con varianza\",\n       x = \"ph\",\n       y = \"inorganico/organico\",\n       fill = \"adesione\"\n       )+\n  annotate(\"label\",\n           x = centro_maggiore$x,\n           y = centro_maggiore$y,\n           label = paste(\"Varianza >\", soglia),\n           fill = \"white\")+\n  annotate(\"label\",\n           x = centro_minore$x,\n           y = centro_minore$y,\n           label = paste(\"Varianza <\", soglia),\n           fill = \"white\")+\n  scale_x_continuous(\n    name = \"Coded unit ph\",\n    sec.axis = sec_axis(\n      ~ scales::rescale(., to = range(dm$A_s)), \n      name = \"pH reale\"\n    )\n  ) +\n  scale_y_continuous(\n    name = \"Coded unit rapporto inorganico/organico\",\n    sec.axis = sec_axis(\n      ~ scales::rescale(., to = range(dm$B_s)), \n      name = \"Rapporto inorganico/organico reale\"\n    )\n  ) +\n  coord_equal()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-14-1.png){fig-align='center' width=16cm}\n:::\n:::\n\n\n# Conclusioni\n\nDall’analisi dei risultati si osserva che **nel range considerato**:\n\n* **Adesione**: il fattore più influente risulta essere il rapporto inorganico/organico, mentre il pH ha un effetto minore. L’aumento del fattore ph produce un incremento dell’adesione, un'aumento del rapporto inorganico/organico invece produce una diminuzione dell'adesione (aumento della classe d'adesione). Questi fattori presentano un effetto lineare nei range considerati. L’interazione tra i due fattori è statisticamente trascurabile in questo intervallo.\n\n* **Durezza**: anche in questo caso, il parametro predominante è il rapporto inorganico/organico, con una risposta lineare: aumentando il rapporto si aumenta la durezza del rivestimento. Il pH  e l'interazione tra i due fattori risultano non risultano statisticamente determinanti.\n\n* **Omogeneità (varianza) della durezza**: aumentando il rapporto inorganico/organico si osserva una diminuzione dell’omogeneità del rivestimento (aumento della varianza). Ph e interazione tra i due fattori risutlano statisticamente non determinanti.\n\nIn sintesi, per ottimizzare le proprietà del rivestimento su substrati di legno (larice) operando sui fattori di sintesi nel range considerato è necessario bilanciare il rapporto inorganico/organico per massimizzare adesione e durezza, senza compromettere l’omogeneità del rivestimento.\n\n\n## Nota finale\n\nSi ribadisce che le conclusioni sopra riportate sono solo esemplificative (non hanno valore scientifico): sono la conseguenza dell'analisi effettuata su dati generati al fine unico di mostrare la metodologia di analisi.\n\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}